{"version":3,"file":"index.js","sources":["../../../../../typhonjs-svelte/lib/_dist/store/reducer/index.js"],"sourcesContent":["import { DynArrayReducer } from '@typhonjs-svelte/runtime-base/data/struct/store/reducer';\nimport { Hashing, Timing, Strings } from '@typhonjs-svelte/runtime-base/util';\nimport { isObject, klona, isIterable } from '@typhonjs-svelte/runtime-base/util/object';\nimport { writable, get } from 'svelte/store';\n\n/**\r\n * Provides a basic test for a given variable to test if it has the shape of a readable store by having a `subscribe`\r\n * function.\r\n *\r\n * Note: functions are also objects, so test that the variable might be a function w/ a `subscribe` function.\r\n *\r\n * @param {*}  store - variable to test that might be a store.\r\n *\r\n * @returns {boolean} Whether the variable tested has the shape of a store.\r\n */\r\n\r\n/**\r\n * Provides a basic test for a given variable to test if it has the shape of a writable store by having a `subscribe`\r\n * `set`, and `update` functions.\r\n *\r\n * Note: functions are also objects, so test that the variable might be a function w/ `subscribe` & `set` functions.\r\n *\r\n * @param {*}  store - variable to test that might be a store.\r\n *\r\n * @returns {boolean} Whether the variable tested has the shape of a store.\r\n */\r\nfunction isWritableStore(store)\r\n{\r\n   if (store === null || store === void 0) { return false; }\r\n\r\n   switch (typeof store)\r\n   {\r\n      case 'function':\r\n      case 'object':\r\n         return typeof store.subscribe === 'function' && typeof store.set === 'function';\r\n   }\r\n\r\n   return false;\r\n}\r\n\r\n/**\r\n * Subscribes to the given store with the update function provided and ignores the first automatic\r\n * update. All future updates are dispatched to the update function.\r\n *\r\n * @param {import('#svelte/store').Readable | import('#svelte/store').Writable} store -\r\n *  Store to subscribe to...\r\n *\r\n * @param {import('#svelte/store').Updater} update - function to receive future updates.\r\n *\r\n * @returns {import('#svelte/store').Unsubscriber} Store unsubscribe function.\r\n */\r\nfunction subscribeIgnoreFirst(store, update)\r\n{\r\n   let firedFirst = false;\r\n\r\n   return store.subscribe((value) =>\r\n   {\r\n      if (!firedFirst)\r\n      {\r\n         firedFirst = true;\r\n      }\r\n      else\r\n      {\r\n         update(value);\r\n      }\r\n   });\r\n}\n\n/**\r\n * Provides a base implementation for store entries in {@link ArrayObjectStore}.\r\n *\r\n * In particular providing the required getting / accessor for the 'id' property.\r\n */\r\nclass ObjectEntryStore\r\n{\r\n   /**\r\n    * @type {object}\r\n    */\r\n   #data;\r\n\r\n   /**\r\n    * Stores the subscribers.\r\n    *\r\n    * @type {(function(object): void)[]}\r\n    */\r\n   #subscriptions = [];\r\n\r\n   /**\r\n    * @param {object}   data -\r\n    */\r\n   constructor(data = {})\r\n   {\r\n      if (!isObject(data)) { throw new TypeError(`'data' is not an object.`); }\r\n\r\n      this.#data = data;\r\n\r\n      // If an id is missing then add it.\r\n      if (typeof data.id !== 'string') { this.#data.id = Hashing.uuidv4(); }\r\n\r\n      if (!Hashing.isUuidv4(data.id)) { throw new Error(`'data.id' (${data.id}) is not a valid UUIDv4 string.`); }\r\n   }\r\n\r\n   /**\r\n    * Invoked by ArrayObjectStore to provide custom duplication. Override this static method in your entry store.\r\n    *\r\n    * @param {object}   data - A copy of local data w/ new ID already set.\r\n    *\r\n    * @param {import('./ArrayObjectStore.js').ArrayObjectStore} arrayStore - The source ArrayObjectStore instance.\r\n    */\r\n   static duplicate(data, arrayStore) {}  // eslint-disable-line no-unused-vars\r\n\r\n   /**\r\n    * @returns {object} The object data tracked by this store.\r\n    * @protected\r\n    */\r\n   get _data() { return this.#data; }\r\n\r\n   // ----------------------------------------------------------------------------------------------------------------\r\n\r\n   /**\r\n    * @returns {string} The ID attribute in object data tracked by this store.\r\n    */\r\n   get id() { return this.#data.id; }\r\n\r\n   toJSON()\r\n   {\r\n      return this.#data;\r\n   }\r\n\r\n   /**\r\n    * @param {function(object): void} handler - Callback function that is invoked on update / changes.\r\n    *\r\n    * @returns {(function(): void)} Unsubscribe function.\r\n    */\r\n   subscribe(handler)\r\n   {\r\n      this.#subscriptions.push(handler);  // add handler to the array of subscribers\r\n\r\n      handler(this.#data);                // call handler with current value\r\n\r\n      // Return unsubscribe function.\r\n      return () =>\r\n      {\r\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\r\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\r\n      };\r\n   }\r\n\r\n   /**\r\n    * @protected\r\n    */\r\n   _updateSubscribers()\r\n   {\r\n      const subscriptions = this.#subscriptions;\r\n\r\n      const data = this.#data;\r\n\r\n      for (let cntr = 0; cntr < subscriptions.length; cntr++) { subscriptions[cntr](data); }\r\n   }\r\n}\n\n/**\r\n * @template [T=import('./').BaseArrayObjectEntryStore]\r\n */\r\nclass ArrayObjectStore\r\n{\r\n   /** @type {T[]} */\r\n   #data = [];\r\n\r\n   /**\r\n    * @type {Map<string, { store: T, unsubscribe: Function}>}\r\n    */\r\n   #dataMap = new Map();\r\n\r\n   /**\r\n    * @type {DynArrayReducer<T>}\r\n    */\r\n   #dataReducer;\r\n\r\n   /**\r\n    * @type {boolean}\r\n    */\r\n   #manualUpdate;\r\n\r\n   /**\r\n    * @type {T}\r\n    */\r\n   #StoreClass;\r\n\r\n   /**\r\n    * Stores the subscribers.\r\n    *\r\n    * @type {(function(T[]): void)[]}\r\n    */\r\n   #subscriptions = [];\r\n\r\n   /**\r\n    * @type {Function}\r\n    */\r\n   #updateSubscribersBound;\r\n\r\n   /**\r\n    * @returns {ObjectEntryStore} The default object entry store constructor.\r\n    */\r\n   static get EntryStore() { return ObjectEntryStore; }\r\n\r\n   /**\r\n    * @param {import('./index.js').ArrayObjectStoreParams} params -\r\n    */\r\n   constructor({ StoreClass, defaultData = [], childDebounce = 250, dataReducer = false, manualUpdate = false } = {})\r\n   {\r\n      if (!Number.isInteger(childDebounce) || childDebounce < 0 || childDebounce > 1000)\r\n      {\r\n         throw new TypeError(`'childDebounce' must be an integer between and including 0 - 1000.`);\r\n      }\r\n\r\n      if (typeof manualUpdate !== 'boolean') { throw new TypeError(`'manualUpdate' is not a boolean.`); }\r\n\r\n      if (!isWritableStore(StoreClass.prototype))\r\n      {\r\n         throw new TypeError(`'StoreClass' is not a writable store constructor.`);\r\n      }\r\n\r\n      let hasIDGetter = false;\r\n\r\n      // Walk parent prototype chain. Check for descriptor at each prototype level.\r\n      for (let o = StoreClass.prototype; o; o = Object.getPrototypeOf(o))\r\n      {\r\n         const descriptor = Object.getOwnPropertyDescriptor(o, 'id');\r\n         if (descriptor !== void 0 && descriptor.get !== void 0)\r\n         {\r\n            hasIDGetter = true;\r\n            break;\r\n         }\r\n      }\r\n\r\n      if (!hasIDGetter)\r\n      {\r\n         throw new TypeError(`'StoreClass' does not have a getter accessor for 'id' property.`);\r\n      }\r\n\r\n      if (!Array.isArray(defaultData)) { throw new TypeError(`'defaultData' is not an array.`); }\r\n\r\n      this.#manualUpdate = manualUpdate;\r\n\r\n      this.#StoreClass = StoreClass;\r\n\r\n      if (dataReducer) { this.#dataReducer = new DynArrayReducer({ data: this.#data }); }\r\n\r\n      // Prepare a debounced callback that is used for all child store entry subscriptions.\r\n      this.#updateSubscribersBound = childDebounce === 0 ? this.updateSubscribers.bind(this) :\r\n       Timing.debounce((data) => this.updateSubscribers(data), childDebounce);\r\n   }\r\n\r\n   /**\r\n    * Provide an iterator for public access to entry stores.\r\n    *\r\n    * @yields {T | void}\r\n    */\r\n   *[Symbol.iterator]()\r\n   {\r\n      if (this.#data.length === 0) { return; }\r\n\r\n      for (const entryStore of this.#data) { yield entryStore; }\r\n   }\r\n\r\n   /**\r\n    * @returns {T[]} The internal data array tracked allowing child classes direct access.\r\n    * @protected\r\n    */\r\n   get _data() { return this.#data; }\r\n\r\n   /**\r\n    * @returns {DynArrayReducer<T>} The data reducer.\r\n    */\r\n   get dataReducer()\r\n   {\r\n      if (!this.#dataReducer)\r\n      {\r\n         throw new Error(\r\n          `'dataReducer' is not initialized; did you forget to specify 'dataReducer' as true in constructor options?`);\r\n      }\r\n\r\n      return this.#dataReducer;\r\n   }\r\n\r\n   /**\r\n    * @returns {number} The length of all data.\r\n    */\r\n   get length() { return this.#data.length; }\r\n\r\n   /**\r\n    * Removes all child store entries.\r\n    */\r\n   clearEntries()\r\n   {\r\n      for (const storeEntryData of this.#dataMap.values()) { storeEntryData.unsubscribe(); }\r\n\r\n      this.#dataMap.clear();\r\n      this.#data.length = 0;\r\n\r\n      this.updateSubscribers();\r\n   }\r\n\r\n   /**\r\n    * Creates a new store from given data.\r\n    *\r\n    * @param {object}   entryData -\r\n    *\r\n    * @returns {T} The store\r\n    */\r\n   createEntry(entryData = {})\r\n   {\r\n      if (!isObject(entryData)) { throw new TypeError(`'entryData' is not an object.`); }\r\n\r\n      if (typeof entryData.id !== 'string') { entryData.id = Hashing.uuidv4(); }\r\n\r\n      if (this.#data.findIndex((entry) => entry.id === entryData.id) >= 0)\r\n      {\r\n         throw new Error(`'entryData.id' (${entryData.id}) already in this ArrayObjectStore instance.`);\r\n      }\r\n\r\n      const store = this.#createStore(entryData);\r\n\r\n      this.updateSubscribers();\r\n\r\n      return store;\r\n   }\r\n\r\n   /**\r\n    * Add a new store entry from the given data.\r\n    *\r\n    * @param {object}   entryData -\r\n    *\r\n    * @returns {T} New store entry instance.\r\n    */\r\n   #createStore(entryData)\r\n   {\r\n      const store = new this.#StoreClass(entryData, this);\r\n\r\n      if (!Hashing.isUuidv4(store.id))\r\n      {\r\n         throw new Error(`'store.id' (${store.id}) is not a UUIDv4 compliant string.`);\r\n      }\r\n\r\n      const unsubscribe = subscribeIgnoreFirst(store, this.#updateSubscribersBound);\r\n\r\n      this.#data.push(store);\r\n      this.#dataMap.set(entryData.id, { store, unsubscribe });\r\n\r\n      return store;\r\n   }\r\n\r\n   /**\r\n    * Deletes a given entry store by ID from this world setting array store instance.\r\n    *\r\n    * @param {string}  id - ID of entry to delete.\r\n    *\r\n    * @returns {boolean} Delete operation successful.\r\n    */\r\n   deleteEntry(id)\r\n   {\r\n      const result = this.#deleteStore(id);\r\n\r\n      if (result) { this.updateSubscribers(); }\r\n\r\n      return result;\r\n   }\r\n\r\n   #deleteStore(id)\r\n   {\r\n      if (typeof id !== 'string') { throw new TypeError(`'id' is not a string.`); }\r\n\r\n      const storeEntryData = this.#dataMap.get(id);\r\n      if (storeEntryData)\r\n      {\r\n         storeEntryData.unsubscribe();\r\n\r\n         this.#dataMap.delete(id);\r\n\r\n         const index = this.#data.findIndex((entry) => entry.id === id);\r\n         if (index >= 0) { this.#data.splice(index, 1); }\r\n\r\n         return true;\r\n      }\r\n\r\n      return false;\r\n   }\r\n\r\n   /**\r\n    * Duplicates an entry store by the given ID.\r\n    *\r\n    * @param {string}   id - UUIDv4 string.\r\n    *\r\n    * @returns {*} Instance of StoreClass.\r\n    */\r\n   duplicateEntry(id)\r\n   {\r\n      if (typeof id !== 'string') { throw new TypeError(`'id' is not a string.`); }\r\n\r\n      const storeEntryData = this.#dataMap.get(id);\r\n\r\n      if (storeEntryData)\r\n      {\r\n         const data = klona(storeEntryData.store.toJSON());\r\n         data.id = Hashing.uuidv4();\r\n\r\n         // Allow StoreClass to statically perform any specialized duplication.\r\n         this.#StoreClass?.duplicate?.(data, this);\r\n\r\n         return this.createEntry(data);\r\n      }\r\n\r\n      return void 0;\r\n   }\r\n\r\n   /**\r\n    * Find an entry in the backing child store array.\r\n    *\r\n    * @param {function(T): T|void}  predicate - A predicate function\r\n    *\r\n    * @returns {T|void} Found entry in array or undefined.\r\n    */\r\n   findEntry(predicate)\r\n   {\r\n      return this.#data.find(predicate);\r\n   }\r\n\r\n   /**\r\n    * Finds an entry store instance by 'id' / UUIDv4.\r\n    *\r\n    * @param {string}   id - A UUIDv4 string.\r\n    *\r\n    * @returns {T|void} Entry store instance.\r\n    */\r\n   getEntry(id)\r\n   {\r\n      const storeEntryData = this.#dataMap.get(id);\r\n      return storeEntryData ? storeEntryData.store : void 0;\r\n   }\r\n\r\n   /**\r\n    * Sets the children store data by 'id', adds new entry store instances, or removes entries that are no longer in the\r\n    * update list.\r\n    *\r\n    * @param {T[]}   updateList -\r\n    */\r\n   set(updateList)\r\n   {\r\n      if (!Array.isArray(updateList))\r\n      {\r\n         console.warn(`ArrayObjectStore.set warning: aborting set operation as 'updateList' is not an array.`);\r\n         return;\r\n      }\r\n\r\n      const data = this.#data;\r\n      const dataMap = this.#dataMap;\r\n\r\n      // Create a set of all current entry IDs.\r\n      const removeIDSet = new Set(dataMap.keys());\r\n\r\n      let rebuildIndex = false;\r\n\r\n      for (let updateIndex = 0; updateIndex < updateList.length; updateIndex++)\r\n      {\r\n         const updateData = updateList[updateIndex];\r\n\r\n         const id = updateData.id;\r\n\r\n         if (typeof id !== 'string') { throw new Error(`'updateData.id' is not a string.`); }\r\n\r\n         const localIndex = data.findIndex((entry) => entry.id === id);\r\n\r\n         if (localIndex >= 0)\r\n         {\r\n            const localEntry = data[localIndex];\r\n\r\n            // Update the entry data.\r\n            localEntry.set(updateData);\r\n\r\n            // Must move to correct position\r\n            if (localIndex !== updateIndex)\r\n            {\r\n               // Remove from current location.\r\n               data.splice(localIndex, 1);\r\n\r\n               if (updateIndex < data.length)\r\n               {\r\n                  // Insert at new location.\r\n                  data.splice(updateIndex, 0, localEntry);\r\n               }\r\n               else\r\n               {\r\n                  // Local data length is less than update data index; rebuild index.\r\n                  rebuildIndex = true;\r\n               }\r\n            }\r\n\r\n            // Delete from removeIDSet as entry is still in local data.\r\n            removeIDSet.delete(id);\r\n         }\r\n         else\r\n         {\r\n            this.#createStore(updateData);\r\n         }\r\n      }\r\n\r\n      if (rebuildIndex)\r\n      {\r\n         // Must invoke unsubscribe for all child stores.\r\n         for (const storeEntryData of dataMap.values()) { storeEntryData.unsubscribe(); }\r\n\r\n         data.length = 0;\r\n         dataMap.clear();\r\n\r\n         for (const updateData of updateList) { this.#createStore(updateData); }\r\n      }\r\n      else\r\n      {\r\n         // Remove entries that are no longer in data.\r\n         for (const id of removeIDSet) { this.#deleteStore(id); }\r\n      }\r\n\r\n      this.updateSubscribers();\r\n   }\r\n\r\n   toJSON()\r\n   {\r\n      return this.#data;\r\n   }\r\n\r\n// -------------------------------------------------------------------------------------------------------------------\r\n\r\n   /**\r\n    * @param {function(T[]): void} handler - Callback function that is invoked on update / changes.\r\n    *\r\n    * @returns {(function(): void)} Unsubscribe function.\r\n    */\r\n   subscribe(handler)\r\n   {\r\n      this.#subscriptions.push(handler); // add handler to the array of subscribers\r\n\r\n      handler(this.#data);                     // call handler with current value\r\n\r\n      // Return unsubscribe function.\r\n      return () =>\r\n      {\r\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\r\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\r\n      };\r\n   }\r\n\r\n   /**\r\n    * Updates subscribers.\r\n    *\r\n    * @param {import('./index.js').ArrayObjectUpdateData}  [update] -\r\n    */\r\n   updateSubscribers(update)\r\n   {\r\n      const updateGate = typeof update === 'boolean' ? update : !this.#manualUpdate;\r\n\r\n      if (updateGate)\r\n      {\r\n         const subscriptions = this.#subscriptions;\r\n\r\n         const data = this.#data;\r\n\r\n         for (let cntr = 0; cntr < subscriptions.length; cntr++) { subscriptions[cntr](data); }\r\n      }\r\n\r\n      // This will update the filtered data and `dataReducer` store and forces an update to subscribers.\r\n      if (this.#dataReducer) { this.#dataReducer.index.update(true); }\r\n   }\r\n}\n\n/**\r\n * @template [T=import('./').BaseArrayObjectEntryStore]\r\n * @augments {ArrayObjectStore<T>}\r\n */\r\nclass CrudArrayObjectStore extends ArrayObjectStore\r\n{\r\n   /** @type {CrudDispatch} */\r\n   #crudDispatch;\r\n\r\n   /** @type {object} */\r\n   #extraData;\r\n\r\n   /**\r\n    * @param {object}                  [opts] - Optional parameters.\r\n    *\r\n    * @param {CrudDispatch}            [opts.crudDispatch] -\r\n    *\r\n    * @param {object}                  [opts.extraData] -\r\n    *\r\n    * @param {import('./index.js').ArrayObjectStoreParams}  [opts.rest] - Rest of ArrayObjectStore parameters.\r\n    */\r\n   constructor({ crudDispatch, extraData, ...rest })\r\n   {\r\n      // 'manualUpdate' is set to true if 'crudUpdate' is defined, but can be overridden by `...rest`.\r\n      super({\r\n         manualUpdate: typeof crudDispatch === 'function',\r\n         ...rest,\r\n      });\r\n\r\n      if (crudDispatch !== void 0 && typeof crudDispatch !== 'function')\r\n      {\r\n         throw new TypeError(`'crudDispatch' is not a function.`);\r\n      }\r\n\r\n      if (extraData !== void 0 && !isObject(extraData))\r\n      {\r\n         throw new TypeError(`'extraData' is not an object.`);\r\n      }\r\n\r\n      this.#crudDispatch = crudDispatch;\r\n      this.#extraData = extraData ?? {};\r\n   }\r\n\r\n   /**\r\n    * Removes all child store entries.\r\n    */\r\n   clearEntries()\r\n   {\r\n      super.clearEntries();\r\n\r\n      if (this.#crudDispatch)\r\n      {\r\n         this.#crudDispatch({ action: 'clear', ...this.#extraData });\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Creates a new store from given data.\r\n    *\r\n    * @param {object}   entryData -\r\n    *\r\n    * @returns {T} Associated store with entry data.\r\n    */\r\n   createEntry(entryData = {})\r\n   {\r\n      const store = super.createEntry(entryData);\r\n\r\n      if (store && this.#crudDispatch)\r\n      {\r\n         this.#crudDispatch({\r\n            action: 'create',\r\n            ...this.#extraData,\r\n            id: store.id,\r\n            data: store.toJSON()\r\n         });\r\n      }\r\n\r\n      return store;\r\n   }\r\n\r\n   /**\r\n    * Deletes a given entry store by ID from this world setting array store instance.\r\n    *\r\n    * @param {string}  id - ID of entry to delete.\r\n    *\r\n    * @returns {boolean} Delete operation successful.\r\n    */\r\n   deleteEntry(id)\r\n   {\r\n      const result = super.deleteEntry(id);\r\n\r\n      if (result && this.#crudDispatch)\r\n      {\r\n         this.#crudDispatch({ action: 'delete', ...this.#extraData, id });\r\n      }\r\n\r\n      return result;\r\n   }\r\n\r\n   /**\r\n    * Updates subscribers, but provides special handling when WorldSettingArrayStore has an `crudDispatch` function\r\n    * attached. When the update is an object with a valid UUIDv4 string as the id property the `crudDispatch`\r\n    * function is invoked with  along with the data payload\r\n    *\r\n    * @param {import('./index.js').ArrayObjectUpdateData} [update] -\r\n    */\r\n   updateSubscribers(update)\r\n   {\r\n      if (this.#crudDispatch && isObject(update) && Hashing.isUuidv4(update.id))\r\n      {\r\n         const result = this.#crudDispatch({\r\n            action: 'update',\r\n            ...this.#extraData,\r\n            id: update.id,\r\n            data: update  // TODO: Consider using klona to clone data.\r\n         });\r\n\r\n         // If the crudDispatch function returns a boolean then invoke 'ArrayObjectStore.updateSubscribers' with it.\r\n         super.updateSubscribers(typeof result === 'boolean' ? result : update);\r\n      }\r\n      else\r\n      {\r\n         super.updateSubscribers(update);\r\n      }\r\n   }\r\n}\r\n\r\n/**\r\n * @typedef {import('./index.js').ArrayObjectStoreParams & CrudArrayObjectStoreParamProps} CrudArrayObjectStoreParams\r\n */\r\n\r\n/**\r\n * @typedef {object} CrudArrayObjectStoreParamProps\r\n *\r\n * @property {CrudDispatch}   [crudDispatch] -\r\n *\r\n * @property {object}         [extraData] -\r\n *\r\n * @internal\r\n */\r\n\r\n/**\r\n * @typedef {(data: { action: string, id?: string, data?: object }) => boolean} CrudDispatch\r\n *\r\n * A function that accepts an object w/ 'action', 'moduleId', 'key' properties and optional 'id' / UUIDv4 string and\r\n * 'data' property.\r\n */\n\n/**\r\n * Creates a filter function to compare objects by a give property key against a regex test. The returned function\r\n * is also a writable Svelte store that builds a regex from the stores value.\r\n *\r\n * This filter function can be used w/ a dynamic reducer and bound as a store to input elements.\r\n *\r\n * @param {string|Iterable<string>}   properties - Property key to compare.\r\n *\r\n * @param {object}   [opts] - Optional parameters.\r\n *\r\n * @param {boolean}  [opts.caseSensitive=false] - When true regex test is case-sensitive.\r\n *\r\n * @param {import('#svelte/store').Writable<string>}  [opts.store=void] - Use the provided store to instead of creating\r\n *        a default writable store.\r\n *\r\n * @returns {((data: object) => boolean) & import('#svelte/store').Writable<string>} The query string filter.\r\n */\r\nfunction regexObjectQuery(properties, { caseSensitive = false, store } = {})\r\n{\r\n   let keyword = '';\r\n   let regex;\r\n\r\n   if (store !== void 0 && !isWritableStore(store))\r\n   {\r\n      throw new TypeError(`createObjectQuery error: 'store' is not a writable store.`);\r\n   }\r\n\r\n   const storeKeyword = store ? store : writable(keyword);\r\n\r\n   // If an existing store is provided then set initial values.\r\n   if (store)\r\n   {\r\n      const current = get(store);\r\n\r\n      if (typeof current === 'string')\r\n      {\r\n         keyword = Strings.normalize(current);\r\n         regex = new RegExp(RegExp.escape(keyword), caseSensitive ? '' : 'i');\r\n      }\r\n      else\r\n      {\r\n         store.set(keyword);\r\n      }\r\n   }\r\n\r\n   /**\r\n    * If there is no filter keyword / regex then do not filter otherwise filter based on the regex\r\n    * created from the search input element.\r\n    *\r\n    * @param {object} data - Data object to test against regex.\r\n    *\r\n    * @returns {boolean} AnimationStore filter state.\r\n    */\r\n   function filterQuery(data)\r\n   {\r\n      if (keyword === '' || !regex) { return true; }\r\n\r\n      if (isIterable(properties))\r\n      {\r\n         for (const property of properties)\r\n         {\r\n            if (regex.test(Strings.normalize(data?.[property]))) { return true; }\r\n         }\r\n\r\n         return false;\r\n      }\r\n      else\r\n      {\r\n         return regex.test(Strings.normalize(data?.[properties]));\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Create a custom store that changes when the search keyword changes.\r\n    *\r\n    * @param {(string) => void} handler - A callback function that accepts strings.\r\n    *\r\n    * @returns {import('#svelte/store').Unsubscriber} Store unsubscribe function.\r\n    */\r\n   filterQuery.subscribe = (handler) =>\r\n   {\r\n      return storeKeyword.subscribe(handler);\r\n   };\r\n\r\n   /**\r\n    * Set\r\n    *\r\n    * @param {string}   value - A new value for the keyword / regex test.\r\n    */\r\n   filterQuery.set = (value) =>\r\n   {\r\n      if (typeof value === 'string')\r\n      {\r\n         keyword = Strings.normalize(value);\r\n         regex = new RegExp(RegExp.escape(keyword), caseSensitive ? '' : 'i');\r\n         storeKeyword.set(keyword);\r\n      }\r\n   };\r\n\r\n   return filterQuery;\r\n}\n\nconst filters = /*#__PURE__*/Object.freeze({\n   __proto__: null,\n   regexObjectQuery: regexObjectQuery\n});\n\n/**\r\n * Provides helper functions to create dynamic store driven filters and sort functions for dynamic reducers. The\r\n * returned functions are also Svelte stores and can be added to a reducer as well as used as a store.\r\n */\r\nclass DynReducerHelper\r\n{\r\n   /**\r\n    * Returns the following filter functions:\r\n    * - regexObjectQuery(property, options); suitable for object reducers matching one or more properties against\r\n    *   the store value as a regex. Optional parameters to set case sensitivity and passing in an existing store.\r\n    *\r\n    * @returns {{\r\n    *    regexObjectQuery: (properties: string|Iterable<string>, options?: {caseSensitive?: boolean, store?: import('#svelte/store').Writable<string>}) => (((data: {}) => boolean) & import('#svelte/store').Writable<string>)\r\n    * }} All available filters.\r\n    */\r\n   static get filters() { return filters; }\r\n}\n\nexport { ArrayObjectStore, CrudArrayObjectStore, DynReducerHelper, ObjectEntryStore };\n//# sourceMappingURL=index.js.map\n"],"names":[],"mappings":"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"}